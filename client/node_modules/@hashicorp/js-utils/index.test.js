import { expect } from 'chai'
import { capitalize, eliminateOrphans, mitigateWidows } from './dist/index'

describe('captitalize', () => {
  it('should capitalize the first letter of the string', () => {
    const input = `hello world...`
    const output = `Hello world...`
    expect(capitalize(input)).to.equal(output)
  })
})

describe('eliminateOrphans', () => {
  it('should replace spaces with &nbsp; in the last 12 chars', () => {
    const input = `this is a wild idea isn't it? i know...`
    const output = `this is a wild idea isn't it?&nbsp;i&nbsp;know...`
    expect(eliminateOrphans(input)).to.equal(output)
  })
})

describe('mitigateWidows', () => {
  const widowTests = [
    {
      itString: 'should return an empty string unmodified',
      string: '',
      expected: ''
    },
    {
      itString: 'should not modify a string with no spaces',
      string: 'thisIsAStringWithNoSpaces',
      expected: 'thisIsAStringWithNoSpaces'
    },
    {
      itString: 'should replace the last space in a basic example',
      string: 'This is a basic widow.',
      expected: 'This is a basic&nbsp;widow.'
    },
    {
      itString:
        'should not replace a space between a long word and short widow.',
      string: 'Long word, widow is relatively short.',
      expected: 'Long word, widow is relatively short.'
    },
    {
      itString: 'should account for a shorter unbreakLimit',
      string: 'Here are some words, hello world.',
      unbreakLimit: 11,
      expected: 'Here are some words, hello world.'
    },
    {
      itString: 'should account for a longer unbreakLimit',
      string: 'Long word, then relatively short.',
      unbreakLimit: 17,
      expected: 'Long word, then relatively&nbsp;short.'
    },
    {
      itString: 'should not replace newlines or tabs',
      string: 'Text\nwith\nnewlines\tand\ttabs.',
      expected: 'Text\nwith\nnewlines\tand\ttabs.'
    }
  ]
  for (let i = 0; i < widowTests.length; i++) {
    const { itString, string, unbreakLimit, expected } = widowTests[i]
    it(itString, () => {
      expect(mitigateWidows(string, unbreakLimit)).to.equal(expected)
    })
  }
})
