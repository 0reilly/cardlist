{"ast":null,"code":"import _regeneratorRuntime from\"/Users/adamoreilly/Desktop/SP2020/TapServer/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/adamoreilly/Desktop/SP2020/TapServer/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/adamoreilly/Desktop/SP2020/TapServer/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useEffect,useState}from'react';import{useParams}from\"react-router-dom\";import OrderFinder from'../apis/OrderFinder';import EmailPoster from'../apis/EmailPoster';import Cards from'../apis/Cards';import{CardElement,useStripe,useElements}from\"@stripe/react-stripe-js\";import CardForm from'./CardForm';import PaymentIntent from'../apis/PaymentIntent';import'react-phone-number-input/style.css';import PhoneInput from'react-phone-number-input';import StartVerify from'../apis/StartVerify';import CheckCode from'../apis/CheckCode';import OTP from\"./OTP\";var Tap=function Tap(){var _useState=useState(new Array(6).fill()),_useState2=_slicedToArray(_useState,2),otp=_useState2[0],setOtp=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),phoneRequested=_useState4[0],setPhoneRequested=_useState4[1];var _useParams=useParams(),id=_useParams.id;var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),clientSecret=_useState6[0],setClientSecret=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),selectedCard=_useState8[0],setSelectedCard=_useState8[1];var stripe=useStripe();var elements=useElements();//from server response\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),items=_useState10[0],setItems=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),acctID=_useState12[0],setAcctId=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),storeName=_useState14[0],setStoreName=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),successURL=_useState16[0],setSuccessURL=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),returnURL=_useState18[0],setReturnURL=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),subtotal=_useState20[0],setSubtotal=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),shipping=_useState22[0],setShipping=_useState22[1];var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),taxes=_useState24[0],setTaxes=_useState24[1];var _useState25=useState(0),_useState26=_slicedToArray(_useState25,2),total=_useState26[0],setTotal=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),phoneError=_useState28[0],setPhoneError=_useState28[1];//billing fields\nvar _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),name=_useState30[0],setName=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),addressOne=_useState32[0],setAddressOne=_useState32[1];var _useState33=useState(\"\"),_useState34=_slicedToArray(_useState33,2),addressTwo=_useState34[0],setAddressTwo=_useState34[1];var _useState35=useState(\"\"),_useState36=_slicedToArray(_useState35,2),city=_useState36[0],setCity=_useState36[1];var _useState37=useState(\"\"),_useState38=_slicedToArray(_useState37,2),state=_useState38[0],setState=_useState38[1];var _useState39=useState(\"\"),_useState40=_slicedToArray(_useState39,2),zip=_useState40[0],setZip=_useState40[1];//from customer\nvar _useState41=useState(\"\"),_useState42=_slicedToArray(_useState41,2),phone=_useState42[0],setPhone=_useState42[1];var _useState43=useState(false),_useState44=_slicedToArray(_useState43,2),phoneEntered=_useState44[0],setPhoneEntered=_useState44[1];var _useState45=useState(\"\"),_useState46=_slicedToArray(_useState45,2),email=_useState46[0],setEmail=_useState46[1];var _useState47=useState(false),_useState48=_slicedToArray(_useState47,2),emailEntered=_useState48[0],setEmailEntered=_useState48[1];var _useState49=useState(),_useState50=_slicedToArray(_useState49,2),newCardForm=_useState50[0],setNewCardForm=_useState50[1];//from stripe\nvar _useState51=useState(),_useState52=_slicedToArray(_useState51,2),cusID=_useState52[0],setCusID=_useState52[1];var _useState53=useState([]),_useState54=_slicedToArray(_useState53,2),paymentMethods=_useState54[0],setPaymentMethods=_useState54[1];var _useState55=useState([]),_useState56=_slicedToArray(_useState55,2),billing=_useState56[0],setBilling=_useState56[1];var _useState57=useState(false),_useState58=_slicedToArray(_useState57,2),billingExists=_useState58[0],setBillingExists=_useState58[1];var _useState59=useState(true),_useState60=_slicedToArray(_useState59,2),disabled=_useState60[0],setDisabled=_useState60[1];var _useState61=useState(false),_useState62=_slicedToArray(_useState61,2),succeeded=_useState62[0],setSucceeded=_useState62[1];var _useState63=useState(null),_useState64=_slicedToArray(_useState63,2),error=_useState64[0],setError=_useState64[1];var _useState65=useState(''),_useState66=_slicedToArray(_useState65,2),processing=_useState66[0],setProcessing=_useState66[1];var cardStyle={style:{base:{color:\"#32325d\",fontFamily:'Arial, sans-serif',fontSmoothing:\"antialiased\",fontSize:\"16px\",\"::placeholder\":{color:\"#32325d\"}},invalid:{color:\"#fa755a\",iconColor:\"#fa755a\"}}};useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return OrderFinder.get(\"/\"+id);case 3:response=_context.sent;console.log(response.data.data);setSucceeded(response.data.data.order[0].paid);setItems(response.data.data.items);setAcctId(response.data.data.order[0].acctid);setStoreName(response.data.data.order[0].storename);setSubtotal(response.data.data.order[0].subtotal);setShipping(response.data.data.order[0].shipping);setTaxes(response.data.data.order[0].taxes);setTotal(response.data.data.order[0].total);setSuccessURL(response.data.data.order[0].successurl);setReturnURL(response.data.data.order[0].returnurl);_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,17]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[]);var setPaid=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return OrderFinder.post(\"/\"+id,{paid:true});case 3:response=_context2.sent;setSucceeded(true);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(error);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function setPaid(){return _ref2.apply(this,arguments);};}();var paymentIntent=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var pi;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();console.log(\"creating payment intent\");_context3.prev=2;_context3.next=5;return PaymentIntent.post(\"/\",{amount:total,customer:cusID,account:acctID});case 5:pi=_context3.sent;console.log(\"payment intent created\"+JSON.stringify(pi));handleSubmit(pi.data.clientSecret);_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](2);console.log(error);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[2,10]]);}));return function paymentIntent(_x){return _ref3.apply(this,arguments);};}();var handleSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(clientSecret){var payload;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"confirming payment\");setProcessing(true);_context4.next=4;return stripe.confirmCardPayment(clientSecret,{payment_method:newCardForm?{card:elements.getElement(CardElement)}:selectedCard.id});case 4:payload=_context4.sent;if(payload.error){setError(\"Payment failed \".concat(payload.error.message));setProcessing(false);}else{setError(null);setProcessing(false);setSucceeded(true);setPaid();}case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSubmit(_x2){return _ref4.apply(this,arguments);};}();var handleEmailSet=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(email!=\"\"){setEmailEntered(true);}case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function handleEmailSet(){return _ref5.apply(this,arguments);};}();var handleEmailPhoneSet=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response,cards;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return EmailPoster.post(\"/check/\",{email:email,phone:phone});case 3:response=_context6.sent;console.log(response.data.data);console.log(\"cusID: \"+response.data.data.customer.id);if(response.data.data.error){_context6.next=26;break;}console.log(\"response error\");setCusID(response.data.data.customer.id);console.log(\"setting billing\");setBilling(response.data.data);if(!(response.data.data.customer.name!=null)){_context6.next=23;break;}_context6.prev=12;_context6.next=15;return Cards.post(\"/\",{id:response.data.data.customer.id});case 15:cards=_context6.sent;if(cards.data.data.paymentMethods.data.length>0){console.log(\"card form false\");setNewCardForm(false);setPaymentMethods(cards.data.data.paymentMethods.data);}else{console.log(\"card form true \");setNewCardForm(true);}_context6.next=22;break;case 19:_context6.prev=19;_context6.t0=_context6[\"catch\"](12);console.log(_context6.t0);case 22:setBillingExists(true);case 23:setPhoneEntered(true);_context6.next=27;break;case 26:setPhoneError(true);case 27:_context6.next=32;break;case 29:_context6.prev=29;_context6.t1=_context6[\"catch\"](0);console.log(_context6.t1);case 32:case\"end\":return _context6.stop();}}},_callee6,null,[[0,29],[12,19]]);}));return function handleEmailPhoneSet(){return _ref6.apply(this,arguments);};}();var handleSetBilling=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var response,cards;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log(name);_context7.prev=1;_context7.next=4;return EmailPoster.post(\"/billing/\",{id:cusID,name:name,address:{line1:addressOne,line2:addressTwo,city:city,state:state,postal_code:zip}});case 4:response=_context7.sent;setBilling(response.data.data);setBillingExists(true);_context7.prev=7;_context7.next=10;return Cards.post(\"/\",{id:response.data.data.customer.id});case 10:cards=_context7.sent;if(cards.data.data.paymentMethods.data!=null){setPaymentMethods(cards.data.data.paymentMethods.data);}else{setNewCardForm(true);}_context7.next=17;break;case 14:_context7.prev=14;_context7.t0=_context7[\"catch\"](7);console.log(_context7.t0);case 17:_context7.next=21;break;case 19:_context7.prev=19;_context7.t1=_context7[\"catch\"](1);case 21:case\"end\":return _context7.stop();}}},_callee7,null,[[1,19],[7,14]]);}));return function handleSetBilling(){return _ref7.apply(this,arguments);};}();var editEmail=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:setCusID(\"\");setEmailEntered(false);setEmail(\"\");setBilling([]);setBillingExists(false);setPaymentMethods([]);case 6:case\"end\":return _context8.stop();}}},_callee8);}));return function editEmail(){return _ref8.apply(this,arguments);};}();var editBilling=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:setBillingExists(false);case 1:case\"end\":return _context9.stop();}}},_callee9);}));return function editBilling(){return _ref9.apply(this,arguments);};}();var editPhone=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:setPhoneEntered(false);setPhoneRequested(false);case 2:case\"end\":return _context10.stop();}}},_callee10);}));return function editPhone(){return _ref10.apply(this,arguments);};}();var cancelEditBilling=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:setBillingExists(true);case 1:case\"end\":return _context11.stop();}}},_callee11);}));return function cancelEditBilling(){return _ref11.apply(this,arguments);};}();function isNumeric(n){return!isNaN(parseInt(n))&&isFinite(n);}function selectPM(paymentMethod){setSelectedCard(paymentMethod);setDisabled(false);}var requestCode=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var verify;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:setPhone(phone);setPhoneRequested(true);setPhoneError(false);console.log(\"requesting code\");console.log(\"phone: \"+phone);//setCodeRequested(true);\n_context12.prev=5;_context12.next=8;return StartVerify.post(\"/\",{phone:phone});case 8:verify=_context12.sent;console.log(verify);_context12.next=15;break;case 12:_context12.prev=12;_context12.t0=_context12[\"catch\"](5);console.log(_context12.t0);case 15:case\"end\":return _context12.stop();}}},_callee12,null,[[5,12]]);}));return function requestCode(){return _ref12.apply(this,arguments);};}();var verifyCode=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var verify;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:console.log(\"verifying code: \"+otp.join(\"\"));//setCodeRequested(true);\n_context13.prev=1;_context13.next=4;return CheckCode.post(\"/\",{phone:phone,code:otp.join(\"\")});case 4:verify=_context13.sent;console.log(JSON.stringify(verify));if(verify.data){//setPhoneEntered true\nhandleEmailPhoneSet();}_context13.next=12;break;case 9:_context13.prev=9;_context13.t0=_context13[\"catch\"](1);console.log(_context13.t0);case 12:case\"end\":return _context13.stop();}}},_callee13,null,[[1,9]]);}));return function verifyCode(){return _ref13.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"h1\",null,storeName)),succeeded?/*#__PURE__*/React.createElement(\"div\",{className:succeeded?\"p-4 justify-content-center result-message\":\"p-4 justify-content-center result-message hidden\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"p\",null,\"Payment succeeded! Click below to view your order summary.\"),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-4 text-center\"},/*#__PURE__*/React.createElement(\"a\",{href:successURL,className:\"btn btn-link p-0 m-0 d-inline align-baseline\"},\"Back\")))):/*#__PURE__*/React.createElement(\"div\",{className:\"row \"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12\"},emailEntered?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"card mt-4 mb-4 \"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},\"Email\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},/*#__PURE__*/React.createElement(\"span\",null,email)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-2 text-right\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-link p-0 m-0 d-inline align-baseline\",onClick:editEmail},\"edit\"))),phoneError?/*#__PURE__*/React.createElement(\"div\",{class:\"alert alert-danger\",role:\"alert\"},\"You entered a phone # that is different from the one you created your account with! Please request a new code with the correct #\"):null,phoneEntered?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},\"Phone\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},/*#__PURE__*/React.createElement(\"span\",null,phone)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-2 text-right\"},/*#__PURE__*/React.createElement(\"button\",{onClick:editPhone,className:\"btn btn-link p-0 m-0 d-inline align-baseline\"},\"edit\"))),/*#__PURE__*/React.createElement(\"div\",null,\" \",billingExists?/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},\"Billing Address\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.name)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.address.line1)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.address.line2)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.address.city)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.address.state)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"span\",null,billing.customer.address.zip))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-2 text-right\"},/*#__PURE__*/React.createElement(\"button\",{onClick:editBilling,className:\"btn btn-link p-0 m-0 d-inline align-baseline\"},\"edit\"))):/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},\"Enter Billing Address\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:name,onChange:function onChange(e){return setName(e.target.value);},placeholder:\"Full Name\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:addressOne,onChange:function onChange(e){return setAddressOne(e.target.value);},placeholder:\"Address Line 1\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:addressTwo,onChange:function onChange(e){return setAddressOne(e.target.value);},placeholder:\"Address Line 2\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:state,onChange:function onChange(e){return setState(e.target.value);},placeholder:\"City\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:city,onChange:function onChange(e){return setCity(e.target.value);},placeholder:\"State\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"input\",{value:zip,onChange:function onChange(e){return setZip(e.target.value);},placeholder:\"Zip\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"button\",{onClick:handleSetBilling,className:\"btn btn-primary  btn-block \"},\"Save Address\"))),/*#__PURE__*/React.createElement(\"div\",null,billing?null:billing.customer.name!=false?/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-2 text-right\"},/*#__PURE__*/React.createElement(\"button\",{onClick:cancelEditBilling,className:\"btn btn-link p-0 m-0 d-inline align-baseline\"},\"cancel\")):null)))):/*#__PURE__*/React.createElement(React.Fragment,null,phoneRequested&&!phoneError?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(OTP,{otp:otp,setOtp:setOtp,verifyCode:verifyCode}))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},\"Phone\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(PhoneInput,{placeholder:\"Enter phone number\",value:phone,onChange:setPhone})),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"button\",{onClick:requestCode,className:\"row btn btn-primary\",type:\"submit\"},\"Verify Phone to retrieve saved payment data\"))))))),newCardForm&&billingExists?/*#__PURE__*/React.createElement(\"div\",{className:\"card mt-4 mb-4 \"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header text-center \"},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center\"},\"Save a New Card\"),/*#__PURE__*/React.createElement(\"p\",null,\"so you don't have to enter it next time!\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(CardForm,{setError:setError,setDisabled:setDisabled,setClientSecret:setClientSecret}),paymentMethods.length>0?/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-2\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return setNewCardForm(false);},className:\"btn btn-link d-inline align-baseline\"},\"Back to Saved Cards\")):null)):billingExists&&!newCardForm?/*#__PURE__*/React.createElement(\"div\",{className:\"card text-center mt-4 mb-4 \"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center\"},\"Saved Cards\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body \"},paymentMethods.map(function(paymentMethod){return/*#__PURE__*/React.createElement(\"div\",{onChange:function onChange(e){return selectPM(paymentMethod);},className:\"row \"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-xs-3\"},/*#__PURE__*/React.createElement(\"input\",{type:\"radio\",name:\"addon\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"span\",null,paymentMethod.card.brand,\" - \",paymentMethod.card.last4)));}),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-2\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return setNewCardForm(true);},className:\"btn btn-primary\"},\"Add a new card\")))):null):/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"card-title\"},\"Quick checkout\"),/*#__PURE__*/React.createElement(\"p\",null,\"Enter your email address to log in or sign up.\"),/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"input\",{value:email,onChange:function onChange(e){return setEmail(e.target.value);},placeholder:\"Email address\",type:\"text\",className:\"mt-2 mb-2 form-control\"}),/*#__PURE__*/React.createElement(\"button\",{onClick:handleEmailSet,className:\"mt-2 mb-2 btn btn-primary btn-block\"},\"Continue with TapPay\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-4 text-nowrap card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center\"},\"Order Details\")),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group list-group-flush\"},items.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},item.name),/*#__PURE__*/React.createElement(\"div\",{className:\"col text-right\"},\"$\",item.price/100)));})),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group list-group-flush\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},\"Subtotal\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col text-right\"},\"$\",subtotal/100))),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},\"Shipping\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col text-right\"},\"$\",shipping/100))),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},\"Taxes\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col text-right\"},\"$\",taxes/100))),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},\"Total\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col text-right\"},\"$\",total/100)))),/*#__PURE__*/React.createElement(\"form\",{id:\"payment-form\",onSubmit:paymentIntent},/*#__PURE__*/React.createElement(\"div\",{className:succeeded?\"p-4 row justified-content-center result-message hidden\":\"p-4 row justified-content-center result-message\"},/*#__PURE__*/React.createElement(\"button\",{disabled:processing||disabled||succeeded,className:\"col btn btn-primary\"},/*#__PURE__*/React.createElement(\"span\",{id:\"button-text\"},processing?/*#__PURE__*/React.createElement(\"div\",{className:\"spinner\",id:\"spinner\"}):\"Pay Now\"))),error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-error\",role:\"alert\"},error)))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-4 text-center\"},/*#__PURE__*/React.createElement(\"a\",{href:returnURL,className:\"btn btn-link p-0 m-0 d-inline align-baseline\"},\"Back\")))));};export default Tap;","map":{"version":3,"sources":["/Users/adamoreilly/Desktop/SP2020/TapServer/client/src/components/Tap.jsx"],"names":["React","Component","useEffect","useState","useParams","OrderFinder","EmailPoster","Cards","CardElement","useStripe","useElements","CardForm","PaymentIntent","PhoneInput","StartVerify","CheckCode","OTP","Tap","Array","fill","otp","setOtp","phoneRequested","setPhoneRequested","id","clientSecret","setClientSecret","selectedCard","setSelectedCard","stripe","elements","items","setItems","acctID","setAcctId","storeName","setStoreName","successURL","setSuccessURL","returnURL","setReturnURL","subtotal","setSubtotal","shipping","setShipping","taxes","setTaxes","total","setTotal","phoneError","setPhoneError","name","setName","addressOne","setAddressOne","addressTwo","setAddressTwo","city","setCity","state","setState","zip","setZip","phone","setPhone","phoneEntered","setPhoneEntered","email","setEmail","emailEntered","setEmailEntered","newCardForm","setNewCardForm","cusID","setCusID","paymentMethods","setPaymentMethods","billing","setBilling","billingExists","setBillingExists","disabled","setDisabled","succeeded","setSucceeded","error","setError","processing","setProcessing","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","fetchData","get","response","console","log","data","order","paid","acctid","storename","successurl","returnurl","setPaid","post","paymentIntent","e","preventDefault","amount","customer","account","pi","JSON","stringify","handleSubmit","confirmCardPayment","payment_method","card","getElement","payload","message","handleEmailSet","handleEmailPhoneSet","cards","length","handleSetBilling","address","line1","line2","postal_code","editEmail","editBilling","editPhone","cancelEditBilling","isNumeric","n","isNaN","parseInt","isFinite","selectPM","paymentMethod","requestCode","verify","verifyCode","join","code","target","value","map","brand","last4","item","price"],"mappings":"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","sourcesContent":["import React , {Component, useEffect, useState} from 'react';\nimport { useParams} from \"react-router-dom\";\nimport OrderFinder from '../apis/OrderFinder';\nimport EmailPoster from '../apis/EmailPoster';\nimport Cards from '../apis/Cards';\nimport {\n    CardElement,\n    useStripe,\n    useElements\n  } from \"@stripe/react-stripe-js\";\nimport CardForm from './CardForm';\nimport PaymentIntent from '../apis/PaymentIntent';\nimport 'react-phone-number-input/style.css'\nimport PhoneInput from 'react-phone-number-input'\nimport StartVerify from '../apis/StartVerify';\nimport CheckCode from '../apis/CheckCode';\n\nimport OTP from \"./OTP\";\n\n\n\n\nconst Tap = () => {\n    const [otp, setOtp] = useState(new Array(6).fill());\n    const [phoneRequested, setPhoneRequested] = useState(false);\n\n    const {id} = useParams();\n    const [clientSecret, setClientSecret] = useState();\n    const [selectedCard, setSelectedCard] = useState();\n    const stripe = useStripe();\n    const elements = useElements();\n    \n    //from server response\n    const [items, setItems] = useState([]);\n    const [acctID, setAcctId] = useState(\"\");\n    const [storeName, setStoreName] = useState(\"\");\n    const [successURL, setSuccessURL] = useState(\"\");\n    const [returnURL, setReturnURL] = useState(\"\");\n    const [subtotal, setSubtotal] = useState(0);\n    const [shipping, setShipping] = useState(0);\n    const [taxes, setTaxes] = useState(0);\n    const [total, setTotal] = useState(0);\n    const [phoneError, setPhoneError] = useState(false);\n    \n    \n    //billing fields\n    const [name, setName] = useState(\"\");\n    const [addressOne, setAddressOne] = useState(\"\");\n    const [addressTwo, setAddressTwo] = useState(\"\");\n    const [city, setCity] = useState(\"\");\n    const [state, setState] = useState(\"\");\n    const [zip, setZip] = useState(\"\");\n\n    //from customer\n    const [phone, setPhone] = useState(\"\");\n    const [phoneEntered, setPhoneEntered] = useState(false);\n    const [email, setEmail] = useState(\"\");\n    const [emailEntered, setEmailEntered] = useState(false);\n    const [newCardForm, setNewCardForm] = useState();\n   \n\n    //from stripe\n    const [cusID, setCusID] = useState();\n    const [paymentMethods, setPaymentMethods] = useState([]);\n    const [billing, setBilling] = useState([]);\n    const [billingExists, setBillingExists] = useState(false);\n    const [disabled, setDisabled] = useState(true);\n    const [succeeded, setSucceeded] = useState(false);\n    const [error, setError] = useState(null);\n    const [processing, setProcessing] = useState('');\n    \n    \n\n\n    const cardStyle = {\n        style: {\n          base: {\n            color: \"#32325d\",\n            fontFamily: 'Arial, sans-serif',\n            fontSmoothing: \"antialiased\",\n            fontSize: \"16px\",\n            \"::placeholder\": {\n              color: \"#32325d\"\n            }\n          },\n          invalid: {\n            color: \"#fa755a\",\n            iconColor: \"#fa755a\"\n          }\n        }\n      };\n\n    useEffect( () => {\n        \n        const fetchData = async () => {\n        \n        \n        try {\n            const response = await OrderFinder.get(\"/\"+id);\n            console.log(response.data.data);\n            setSucceeded(response.data.data.order[0].paid);\n            \n            setItems(response.data.data.items)\n            setAcctId(response.data.data.order[0].acctid);\n            setStoreName(response.data.data.order[0].storename);\n            setSubtotal(response.data.data.order[0].subtotal);\n            setShipping(response.data.data.order[0].shipping);\n            setTaxes(response.data.data.order[0].taxes);\n            setTotal(response.data.data.order[0].total);\n            setSuccessURL(response.data.data.order[0].successurl);\n            setReturnURL(response.data.data.order[0].returnurl);\n         } catch(err){\n           console.log(err)\n         }\n            \n        \n       }\n       fetchData();\n\n    },[]);\n\n    const setPaid = async () => {\n        try {\n            const response = await OrderFinder.post(\"/\"+id, {\n                paid: true\n            });\n            setSucceeded(true);\n        }\n        catch (err){\n            console.log(error)\n        }\n    }\n        \n\n    const paymentIntent = async (e) => {\n  \n        e.preventDefault();\n        console.log(\"creating payment intent\")\n        try {\n            const pi = await PaymentIntent.post(\"/\", {\n                \n                    amount : total,\n                    customer : cusID,\n                    account: acctID,\n                \n            });\n            console.log(\"payment intent created\"+JSON.stringify(pi))\n            handleSubmit(pi.data.clientSecret);\n        }\n        catch (err){\n            console.log(error)\n        }\n              \n           \n      }\n      \n        const handleSubmit = async (clientSecret) => {\n          console.log(\"confirming payment\")\n          setProcessing(true);\n          const payload = await stripe.confirmCardPayment(clientSecret, {\n            payment_method: (newCardForm ? {\n                card : elements.getElement(CardElement) \n              } : selectedCard.id) \n          });\n          if (payload.error) {\n            setError(`Payment failed ${payload.error.message}`);\n            setProcessing(false);\n          } else {\n              \n            setError(null);\n            setProcessing(false);\n            setSucceeded(true);\n            setPaid();\n           \n          }\n        };\n      \n\n\n    const handleEmailSet = async () => {\n        if(email != \"\"){\n            setEmailEntered(true)\n        }\n        \n    };\n\n\n    const handleEmailPhoneSet = async () => {\n        \n        try{\n            const response = await EmailPoster.post(\"/check/\", {\n                email,\n                phone\n            })\n            console.log(response.data.data)\n            console.log(\"cusID: \"+response.data.data.customer.id) \n            if(!response.data.data.error){\n            console.log(\"response error\")\n            setCusID(response.data.data.customer.id)\n            console.log(\"setting billing\")\n            setBilling(response.data.data);\n                if(response.data.data.customer.name != null){\n                    //if billing, look up cards\n                    try {\n                        const cards = await Cards.post(\"/\", {\n                            id: response.data.data.customer.id\n                        });\n                        \n                        if(cards.data.data.paymentMethods.data.length > 0){\n                            console.log(\"card form false\")\n                            setNewCardForm(false)\n                            setPaymentMethods(cards.data.data.paymentMethods.data)\n                            \n                        }\n                        else{\n                            console.log(\"card form true \")\n                            setNewCardForm(true);\n                        }\n                        \n                    } catch(err){\n                    console.log(err)\n                    }\n\n                    \n                    setBillingExists(true)\n                }\n            setPhoneEntered(true)\n            }\n            else{\n                setPhoneError(true)\n            }\n        } catch(err){\n            console.log(err)\n        }\n        \n        \n    };\n\n    const handleSetBilling = async () => {\n        console.log(name)\n        try{\n            const response = await EmailPoster.post(\"/billing/\", {\n                    id: cusID,\n                    name,\n                    address : {\n                        line1 : addressOne,\n                        line2 : addressTwo,\n                        city,\n                        state,\n                        postal_code : zip\n                    },\n                \n            })\n            \n            setBilling(response.data.data)\n            setBillingExists(true)\n            try {\n                const cards = await Cards.post(\"/\", {\n                    id: response.data.data.customer.id\n                });\n                \n                if(cards.data.data.paymentMethods.data!= null){\n                    setPaymentMethods(cards.data.data.paymentMethods.data)\n                }\n                else{\n                    setNewCardForm(true);\n                }\n                   \n             } catch(err){\n               console.log(err)\n             }\n        } catch(err){\n\n        }\n        //load saved cards\n        \n        \n    };\n\n    const editEmail = async () => {\n        setCusID(\"\")\n        setEmailEntered(false)\n        setEmail(\"\")\n        setBilling([])\n        setBillingExists(false);\n        setPaymentMethods([])\n    };\n\n    const editBilling = async () => {\n        setBillingExists(false);\n    };\n\n    const editPhone = async () => {\n        setPhoneEntered(false)\n        setPhoneRequested(false)\n    };\n\n\n    const cancelEditBilling = async () => {\n        setBillingExists(true);\n    };\n\n  function isNumeric(n) {\n    return !isNaN(parseInt(n)) && isFinite(n);\n}\nfunction selectPM(paymentMethod){\n    setSelectedCard(paymentMethod);\n    setDisabled(false)\n}\n\nconst requestCode = async () => {\n    setPhone(phone);\n    setPhoneRequested(true)\n    setPhoneError(false)\n    \n    console.log(\"requesting code\")\n    console.log(\"phone: \"+phone)\n    //setCodeRequested(true);\n    try {\n        const verify = await StartVerify.post(\"/\", {\n            phone\n        });\n        console.log(verify)\n    } catch (error) {\n        console.log(error)\n    }\n}\n\nconst verifyCode = async () => {\n    \n    console.log(\"verifying code: \" +otp.join(\"\"))\n   \n    //setCodeRequested(true);\n    try {\n        const verify = await CheckCode.post(\"/\", {\n            phone,\n            code: otp.join(\"\")\n        });\n        console.log(JSON.stringify(verify))\n        if(verify.data){\n            //setPhoneEntered true\n            \n            \n            handleEmailPhoneSet();\n\n        }\n    } catch (error) {\n        console.log(error)\n    }\n}\n\n    return (\n        <>\n         \n        <div className=\"text-center\">\n            <h1>{storeName}</h1>\n            \n        </div>\n             \n        {succeeded ? \n        <div className={succeeded ? \"p-4 justify-content-center result-message\" : \"p-4 justify-content-center result-message hidden\"}>\n             \n            <div className=\"row\">\n                <p>Payment succeeded! Click below to view your order summary.</p>\n                <div className=\"mt-4 text-center\"><a href={successURL} className=\"btn btn-link p-0 m-0 d-inline align-baseline\">Back</a></div>\n            </div>\n        </div>\n            : \n               \n            <div className=\"row \">\n            <div className=\"col-sm-12\">\n              \n\n            {emailEntered ? \n            <>\n            <div className=\"card mt-4 mb-4 \">\n                <div className=\"card-body\">\n                    \n                    <div className=\"row mt-4\">\n                        <div className=\"col-sm-4\">Email</div>\n                        <div className=\"col-sm-4\"><span>{email}</span></div>\n                        <div className=\"col-sm-2 text-right\"><button className=\"btn btn-link p-0 m-0 d-inline align-baseline\"onClick={editEmail}>edit</button></div>\n                    </div> \n                    {phoneError ? \n                        <div class=\"alert alert-danger\" role=\"alert\">\n                        You entered a phone # that is different from the one you created your account with! Please request a new code with the correct #\n                        </div>\n                        : null}\n                        {phoneEntered ?  \n                        <>\n                        <div className=\"row mt-4\">\n                        <div className=\"col-sm-4\">Phone</div>\n                        <div className=\"col-sm-4\"><span>{phone}</span></div>\n                        <div className=\"col-sm-2 text-right\"><button onClick={editPhone} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >edit</button></div>\n                        </div> \n                        \n                        <div> {billingExists ? \n                        \n                            <div className=\"row mt-4\">\n                                <div className=\"col-sm-4\">Billing Address</div>\n                                <div className=\"col-sm-4\"> \n    \n                                    <div className=\"row\"><span>{billing.customer.name}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.line1}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.line2}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.city}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.state}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.zip}</span></div>\n                                </div>\n                                <div className=\"col-sm-2 text-right\"><button onClick={editBilling} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >edit</button></div>\n                                \n                            </div>\n                            \n                            :\n                            \n                             <div className=\"row mt-4\">\n                                 \n                                    <div className=\"col-sm-4\">Enter Billing Address</div>\n                                    <div className=\"col-sm-4\">\n                                        <div className=\"row mt-2\">\n                                            <input \n                                        value={name}\n                                        onChange={(e) => setName(e.target.value)} \n                                        placeholder=\"Full Name\">\n                                            </input></div>\n                                        <div className=\"row mt-2\"><input \n                                        value={addressOne}\n                                        onChange={(e) => setAddressOne(e.target.value)} \n                                        placeholder=\"Address Line 1\"></input></div>\n                                        <div className=\"row mt-2\"><input \n                                        value={addressTwo}\n                                        onChange={(e) => setAddressOne(e.target.value)} \n                                        placeholder=\"Address Line 2\"></input></div> \n                                        <div className=\"row mt-2\"><input\n                                        value={state}\n                                        onChange={(e) => setState(e.target.value)} \n                                        placeholder=\"City\"></input></div> \n                                        <div className=\"row mt-2\"><input \n                                        value={city}\n                                        onChange={(e) => setCity(e.target.value)} \n                                        placeholder=\"State\"></input></div> \n                                        <div className=\"row mt-2\"><input \n                                        value={zip}\n                                        onChange={(e) => setZip(e.target.value)} \n                                        placeholder=\"Zip\"></input></div> \n                                        <div className=\"row mt-2\"><button onClick={handleSetBilling} className=\"btn btn-primary  btn-block \">Save Address</button></div>\n                                    \n                                    </div>\n                                    <div>\n                                        {billing ? null : (billing.customer.name!=false  ?   <div className=\"col-sm-2 text-right\"><button onClick={cancelEditBilling} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >cancel</button></div>\n                                    : null) }\n                                    </div>\n                                    \n                                \n                             </div>\n                            }</div>\n                            </>\n                        : \n                        \n                                <>\n                                {phoneRequested && !phoneError? \n                                <>\n                                <div >\n                                <OTP otp={otp} setOtp={setOtp} verifyCode={verifyCode}></OTP>\n                                </div>\n                                \n                                </>\n                                \n                                :\n                                <>\n                                <div className=\"row\">\n                                    <div className=\"col\">Phone</div>\n                                    <div className=\"col\"><PhoneInput\n                                        placeholder=\"Enter phone number\"\n                                        value={phone}\n                                        onChange={setPhone}/>\n                                    </div>\n                                \n                                <div className=\"col\"><button onClick={requestCode} className=\"row btn btn-primary\" type=\"submit\">\n                                \n                                Verify Phone to retrieve saved payment data\n                                </button></div>\n                                </div>\n                                </>\n                                }\n                                \n                                \n                                </>\n                                \n                            \n                       }\n                        \n\n                        \n                    \n                        \n                    </div> \n                </div>    \n\n                    {newCardForm && billingExists ? \n                    <div className=\"card mt-4 mb-4 \">\n                        <div className=\"card-header text-center \">\n                            <h4  className=\"text-center\">Save a New Card</h4>\n                            <p>so you don't have to enter it next time!</p>\n                        </div>\n                        <div className=\"card-body\">\n                        \n                            <CardForm setError={setError} setDisabled={setDisabled} setClientSecret={setClientSecret}/>\n                        \n                        {paymentMethods.length > 0 ? <div className=\"col-sm-2\"><button onClick={() => setNewCardForm(false)} className=\"btn btn-link d-inline align-baseline\" >Back to Saved Cards</button></div> : null}\n                        </div>\n                    </div>\n                    \n                    : (billingExists && !newCardForm ? \n                \n                    <div className=\"card text-center mt-4 mb-4 \">\n                            <div className=\"card-header\">\n                                <h4  className=\"text-center\">Saved Cards</h4>\n                            </div>\n                            <div className=\"card-body \">\n                            {paymentMethods.map(paymentMethod=>{\n                                return(\n                                    <div onChange={(e) => selectPM(paymentMethod)} className=\"row \">\n                                        <div className=\"col-xs-3\"><input \n                                        type=\"radio\" \n                                        name=\"addon\" \n                                        /></div>\n                                        <div className=\"col\"><span>{paymentMethod.card.brand} - {paymentMethod.card.last4}</span></div>\n                                    </div>\n                                )\n                            })}\n                             <div className=\"row mt-2\"><button onClick={() => setNewCardForm(true)}className=\"btn btn-primary\">Add a new card</button></div>\n                            </div>\n                        </div> : null)}\n            </>\n               :\n              \n              <div className=\"card\">\n                    <div className=\"card-body\">\n                        <h5 className=\"card-title\">Quick checkout</h5>\n                        <p>Enter your email address to log in or sign up.</p>\n                        <div className=\"\">\n                            \n                            <input \n                            value={email}\n                            onChange={(e) => setEmail(e.target.value)}\n                            placeholder=\"Email address\"\n                            type=\"text\" \n                            className=\"mt-2 mb-2 form-control\" \n                            />\n                            <button onClick={handleEmailSet} className=\"mt-2 mb-2 btn btn-primary btn-block\">Continue with TapPay</button>   \n                        </div>\n                    </div>\n                   \n                </div> \n                }\n                \n        \n                <div className=\"mt-4 text-nowrap card\">\n                    <div className=\"card-header\">\n                        <h4  className=\"text-center\">Order Details</h4>\n                    </div>\n                                <ul className=\"list-group list-group-flush\">\n                    {items.map(item=>{\n                 return(  \n                                <li className=\"list-group-item\">\n                                    <div className=\"row\">\n                                    <div className=\"col\">{item.name}</div> \n                                    <div className=\"col text-right\">${item.price/100}</div>\n                                    </div>\n                                </li>\n                    )\n             })}\n                     </ul>\n                     <div className=\"card-body\">\n                        <ul className=\"list-group list-group-flush\">\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Subtotal</div> \n                                <div className=\"col text-right\">${subtotal/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Shipping</div> \n                                <div className=\"col text-right\">${shipping/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Taxes</div> \n                                <div className=\"col text-right\">${taxes/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Total</div> \n                                <div className=\"col text-right\">${total/100}</div>\n                                </div>\n                            </li>\n                        </ul>\n                        <form id=\"payment-form\" onSubmit={paymentIntent}>\n                    <div className={succeeded ? \"p-4 row justified-content-center result-message hidden\" : \"p-4 row justified-content-center result-message\" }><button\n                        disabled={processing || disabled || succeeded}\n                        className=\"col btn btn-primary\"\n                    >\n                        <span id=\"button-text\">\n                        {processing ? (\n                            <div className=\"spinner\" id=\"spinner\"></div>\n                        ) : (\n                            \"Pay Now\"\n                        )} \n                        </span>\n                    </button></div>\n                    {/* Show any error that happens when processing the payment */}\n                    {error && (\n                        <div className=\"card-error\" role=\"alert\">\n                        {error}\n                        </div>\n                    )}\n                    \n                    </form>\n                    </div>\n                \n            </div>\n\n            <div className=\"mt-4 text-center\"><a href={returnURL} className=\"btn btn-link p-0 m-0 d-inline align-baseline\">Back</a></div>\n            </div>\n         \n          </div>\n        }\n       \n            \n        </>\n    )\n}\n\nexport default Tap;\n"]},"metadata":{},"sourceType":"module"}