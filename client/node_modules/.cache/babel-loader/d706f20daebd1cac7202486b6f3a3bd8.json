{"ast":null,"code":"var _jsxFileName = \"/Users/adamoreilly/Desktop/SP2020/TapServer/client/src/components/Tap.jsx\";\nimport React, { Component, useEffect, useState } from 'react';\nimport { useParams } from \"react-router-dom\";\nimport OrderFinder from '../apis/OrderFinder';\nimport EmailPoster from '../apis/EmailPoster';\nimport Cards from '../apis/Cards';\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport CardForm from './CardForm';\nimport PaymentIntent from '../apis/PaymentIntent';\nimport 'react-phone-number-input/style.css';\nimport PhoneInput from 'react-phone-number-input';\nimport StartVerify from '../apis/StartVerify';\nimport CheckCode from '../apis/CheckCode';\nimport OTP from \"./OTP\";\n\nconst Tap = () => {\n  const [otp, setOtp] = useState(new Array(6).fill());\n  const [phoneRequested, setPhoneRequested] = useState(false);\n  const {\n    id\n  } = useParams();\n  const [clientSecret, setClientSecret] = useState();\n  const [selectedCard, setSelectedCard] = useState();\n  const stripe = useStripe();\n  const elements = useElements(); //from server response\n\n  const [items, setItems] = useState([]);\n  const [acctID, setAcctId] = useState(\"\");\n  const [storeName, setStoreName] = useState(\"\");\n  const [successURL, setSuccessURL] = useState(\"\");\n  const [returnURL, setReturnURL] = useState(\"\");\n  const [subtotal, setSubtotal] = useState(0);\n  const [shipping, setShipping] = useState(0);\n  const [taxes, setTaxes] = useState(0);\n  const [total, setTotal] = useState(0);\n  const [phoneError, setPhoneError] = useState(false); //billing fields\n\n  const [name, setName] = useState(\"\");\n  const [addressOne, setAddressOne] = useState(\"\");\n  const [addressTwo, setAddressTwo] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [state, setState] = useState(\"\");\n  const [zip, setZip] = useState(\"\"); //from customer\n\n  const [phone, setPhone] = useState(\"\");\n  const [phoneEntered, setPhoneEntered] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [emailEntered, setEmailEntered] = useState(false);\n  const [newCardForm, setNewCardForm] = useState(); //from stripe\n\n  const [cusID, setCusID] = useState();\n  const [paymentMethods, setPaymentMethods] = useState([]);\n  const [billing, setBilling] = useState([]);\n  const [billingExists, setBillingExists] = useState(false);\n  const [disabled, setDisabled] = useState(true);\n  const [succeeded, setSucceeded] = useState(false);\n  const [error, setError] = useState(null);\n  const [processing, setProcessing] = useState('');\n  const cardStyle = {\n    style: {\n      base: {\n        color: \"#32325d\",\n        fontFamily: 'Arial, sans-serif',\n        fontSmoothing: \"antialiased\",\n        fontSize: \"16px\",\n        \"::placeholder\": {\n          color: \"#32325d\"\n        }\n      },\n      invalid: {\n        color: \"#fa755a\",\n        iconColor: \"#fa755a\"\n      }\n    }\n  };\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await OrderFinder.get(\"/\" + id);\n        console.log(response.data.data);\n        setSucceeded(response.data.data.order[0].paid);\n        setItems(response.data.data.items);\n        setAcctId(response.data.data.order[0].acctid);\n        setStoreName(response.data.data.order[0].storename);\n        setSubtotal(response.data.data.order[0].subtotal);\n        setShipping(response.data.data.order[0].shipping);\n        setTaxes(response.data.data.order[0].taxes);\n        setTotal(response.data.data.order[0].total);\n        setSuccessURL(response.data.data.order[0].successurl);\n        setReturnURL(response.data.data.order[0].returnurl);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  const setPaid = async () => {\n    try {\n      const response = await OrderFinder.post(\"/\" + id, {\n        paid: true\n      });\n      setSucceeded(true);\n    } catch (err) {\n      console.log(error);\n    }\n  };\n\n  const paymentIntent = async e => {\n    e.preventDefault();\n    console.log(\"creating payment intent\");\n\n    try {\n      const pi = await PaymentIntent.post(\"/\", {\n        amount: total,\n        customer: cusID,\n        account: acctID\n      });\n      console.log(\"payment intent created\" + JSON.stringify(pi));\n      handleSubmit(pi.data.clientSecret);\n    } catch (err) {\n      console.log(error);\n    }\n  };\n\n  const handleSubmit = async clientSecret => {\n    console.log(\"confirming payment\");\n    setProcessing(true);\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: newCardForm ? {\n        card: elements.getElement(CardElement)\n      } : selectedCard.id\n    });\n\n    if (payload.error) {\n      setError(`Payment failed ${payload.error.message}`);\n      setProcessing(false);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setSucceeded(true);\n      setPaid();\n    }\n  };\n\n  const handleEmailSet = async () => {\n    if (email != \"\") {\n      setEmailEntered(true);\n    }\n  };\n\n  const handleEmailPhoneSet = async () => {\n    try {\n      const response = await EmailPoster.post(\"/check/\", {\n        email,\n        phone\n      });\n      console.log(response.data.data);\n\n      if (!response.data.data.error) {\n        setPhoneEntered(true);\n        console.log(\"cusID: \" + response.data.data.customer.id);\n        setCusID(response.data.data.customer.id);\n\n        if (response.data.data.customer.name != null) {\n          setBilling(response.data.data);\n          setBillingExists(true); //if billing, look up cards\n\n          try {\n            const cards = await Cards.post(\"/\", {\n              id: response.data.data.customer.id\n            });\n\n            if (cards.data.data.paymentMethods.data.length > 0) {\n              console.log(\"card form false\");\n              setNewCardForm(false);\n              setPaymentMethods(cards.data.data.paymentMethods.data);\n            } else {\n              console.log(\"card form true \");\n              setNewCardForm(true);\n            }\n          } catch (err) {\n            console.log(err);\n          }\n        }\n      } else {\n        setPhoneError(true);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const handleSetBilling = async () => {\n    console.log(name);\n\n    try {\n      const response = await EmailPoster.post(\"/billing/\", {\n        id: cusID,\n        name,\n        address: {\n          line1: addressOne,\n          line2: addressTwo,\n          city,\n          state,\n          postal_code: zip\n        }\n      });\n      setBilling(response.data.data);\n      setBillingExists(true);\n\n      try {\n        const cards = await Cards.post(\"/\", {\n          id: response.data.data.customer.id\n        });\n\n        if (cards.data.data.paymentMethods.data != null) {\n          setPaymentMethods(cards.data.data.paymentMethods.data);\n        } else {\n          setNewCardForm(true);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    } catch (err) {} //load saved cards\n\n  };\n\n  const editEmail = async () => {\n    setCusID(\"\");\n    setEmailEntered(false);\n    setEmail(\"\");\n    setBilling([]);\n    setBillingExists(false);\n    setPaymentMethods([]);\n  };\n\n  const editBilling = async () => {\n    setBillingExists(false);\n  };\n\n  const editPhone = async () => {\n    setPhoneEntered(false);\n    setPhoneRequested(false);\n  };\n\n  const cancelEditBilling = async () => {\n    setBillingExists(true);\n  };\n\n  function isNumeric(n) {\n    return !isNaN(parseInt(n)) && isFinite(n);\n  }\n\n  function selectPM(paymentMethod) {\n    setSelectedCard(paymentMethod);\n    setDisabled(false);\n  }\n\n  const requestCode = async () => {\n    setPhone(phone);\n    setPhoneRequested(true);\n    setPhoneError(false);\n    console.log(\"requesting code\");\n    console.log(\"phone: \" + phone); //setCodeRequested(true);\n\n    try {\n      const verify = await StartVerify.post(\"/\", {\n        phone\n      });\n      console.log(verify);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const verifyCode = async () => {\n    console.log(\"verifying code: \" + otp.join(\"\")); //setCodeRequested(true);\n\n    try {\n      const verify = await CheckCode.post(\"/\", {\n        phone,\n        code: otp.join(\"\")\n      });\n      console.log(JSON.stringify(verify));\n\n      if (verify.data) {\n        //setPhoneEntered true\n        handleEmailPhoneSet();\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 13\n    }\n  }, storeName)), succeeded ? /*#__PURE__*/React.createElement(\"div\", {\n    className: succeeded ? \"p-4 justify-content-center result-message\" : \"p-4 justify-content-center result-message hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 17\n    }\n  }, \"Payment succeeded! Click below to view your order summary.\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mt-4 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: successURL,\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 51\n    }\n  }, \"Back\")))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 13\n    }\n  }, emailEntered ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card mt-4 mb-4 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 25\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 51\n    }\n  }, email)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-2 text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    onClick: editEmail,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 62\n    }\n  }, \"edit\"))), phoneError ? /*#__PURE__*/React.createElement(\"div\", {\n    class: \"alert alert-danger\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 25\n    }\n  }, \"You entered a phone # that is different from the one you created your account with! Please request a new code with the correct #\") : null, phoneEntered ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 25\n    }\n  }, \"Phone\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 51\n    }\n  }, phone)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-2 text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: editPhone,\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 62\n    }\n  }, \"edit\"))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 25\n    }\n  }, \" \", billingExists ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 33\n    }\n  }, \"Billing Address\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 58\n    }\n  }, billing.customer.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 58\n    }\n  }, billing.customer.address.line1)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 58\n    }\n  }, billing.customer.address.line2)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 58\n    }\n  }, billing.customer.address.city)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 58\n    }\n  }, billing.customer.address.state)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 58\n    }\n  }, billing.customer.address.zip))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-2 text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: editBilling,\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 70\n    }\n  }, \"edit\"))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 37\n    }\n  }, \"Enter Billing Address\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: name,\n    onChange: e => setName(e.target.value),\n    placeholder: \"Full Name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 45\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: addressOne,\n    onChange: e => setAddressOne(e.target.value),\n    placeholder: \"Address Line 1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 67\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: addressTwo,\n    onChange: e => setAddressOne(e.target.value),\n    placeholder: \"Address Line 2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 67\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: state,\n    onChange: e => setState(e.target.value),\n    placeholder: \"City\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 67\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: city,\n    onChange: e => setCity(e.target.value),\n    placeholder: \"State\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 67\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: zip,\n    onChange: e => setZip(e.target.value),\n    placeholder: \"Zip\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 67\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSetBilling,\n    className: \"btn btn-primary  btn-block \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 67\n    }\n  }, \"Save Address\"))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 37\n    }\n  }, billing ? null : billing.customer.name != false ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-2 text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 94\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: cancelEditBilling,\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 131\n    }\n  }, \"cancel\")) : null)))) : /*#__PURE__*/React.createElement(React.Fragment, null, phoneRequested && !phoneError ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(OTP, {\n    otp: otp,\n    setOtp: setOtp,\n    verifyCode: verifyCode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 33\n    }\n  }))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 37\n    }\n  }, \"Phone\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(PhoneInput, {\n    placeholder: \"Enter phone number\",\n    value: phone,\n    onChange: setPhone,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 58\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: requestCode,\n    className: \"row btn btn-primary\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 54\n    }\n  }, \"Verify Phone to retrieve saved payment data\"))))))), newCardForm && billingExists ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card mt-4 mb-4 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header text-center \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 29\n    }\n  }, \"Save a New Card\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 29\n    }\n  }, \"so you don't have to enter it next time!\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(CardForm, {\n    setError: setError,\n    setDisabled: setDisabled,\n    setClientSecret: setClientSecret,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 29\n    }\n  }), paymentMethods.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 54\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setNewCardForm(false),\n    className: \"btn btn-link d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 80\n    }\n  }, \"Back to Saved Cards\")) : null)) : billingExists && !newCardForm ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card text-center mt-4 mb-4 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 515,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 33\n    }\n  }, \"Saved Cards\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 29\n    }\n  }, paymentMethods.map(paymentMethod => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      onChange: e => selectPM(paymentMethod),\n      className: \"row \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-xs-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"addon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 67\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 62\n      }\n    }, paymentMethod.card.brand, \" - \", paymentMethod.card.last4)));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setNewCardForm(true),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 56\n    }\n  }, \"Add a new card\")))) : null) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 537,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"card-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 25\n    }\n  }, \"Quick checkout\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 25\n    }\n  }, \"Enter your email address to log in or sign up.\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 541,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    placeholder: \"Email address\",\n    type: \"text\",\n    className: \"mt-2 mb-2 form-control\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 543,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleEmailSet,\n    className: \"mt-2 mb-2 btn btn-primary btn-block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 29\n    }\n  }, \"Continue with TapPay\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mt-4 text-nowrap card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 560,\n      columnNumber: 25\n    }\n  }, \"Order Details\")), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"list-group list-group-flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 33\n    }\n  }, items.map(item => {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      className: \"list-group-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 566,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 37\n      }\n    }, item.name), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col text-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 568,\n        columnNumber: 37\n      }\n    }, \"$\", item.price / 100)));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"list-group list-group-flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    className: \"list-group-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 577,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 578,\n      columnNumber: 33\n    }\n  }, \"Subtotal\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 579,\n      columnNumber: 33\n    }\n  }, \"$\", subtotal / 100))), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"list-group-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 584,\n      columnNumber: 33\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 33\n    }\n  }, \"$\", shipping / 100))), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"list-group-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 33\n    }\n  }, \"Taxes\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 33\n    }\n  }, \"$\", taxes / 100))), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"list-group-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 596,\n      columnNumber: 33\n    }\n  }, \"Total\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 33\n    }\n  }, \"$\", total / 100)))), /*#__PURE__*/React.createElement(\"form\", {\n    id: \"payment-form\",\n    onSubmit: paymentIntent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: succeeded ? \"p-4 row justified-content-center result-message hidden\" : \"p-4 row justified-content-center result-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 602,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: processing || disabled || succeeded,\n    className: \"col btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 602,\n      columnNumber: 160\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"button-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 606,\n      columnNumber: 25\n    }\n  }, processing ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner\",\n    id: \"spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 608,\n      columnNumber: 29\n    }\n  }) : \"Pay Now\"))), error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-error\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 616,\n      columnNumber: 25\n    }\n  }, error)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mt-4 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: returnURL,\n    className: \"btn btn-link p-0 m-0 d-inline align-baseline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 47\n    }\n  }, \"Back\")))));\n};\n\nexport default Tap;","map":{"version":3,"sources":["/Users/adamoreilly/Desktop/SP2020/TapServer/client/src/components/Tap.jsx"],"names":["React","Component","useEffect","useState","useParams","OrderFinder","EmailPoster","Cards","CardElement","useStripe","useElements","CardForm","PaymentIntent","PhoneInput","StartVerify","CheckCode","OTP","Tap","otp","setOtp","Array","fill","phoneRequested","setPhoneRequested","id","clientSecret","setClientSecret","selectedCard","setSelectedCard","stripe","elements","items","setItems","acctID","setAcctId","storeName","setStoreName","successURL","setSuccessURL","returnURL","setReturnURL","subtotal","setSubtotal","shipping","setShipping","taxes","setTaxes","total","setTotal","phoneError","setPhoneError","name","setName","addressOne","setAddressOne","addressTwo","setAddressTwo","city","setCity","state","setState","zip","setZip","phone","setPhone","phoneEntered","setPhoneEntered","email","setEmail","emailEntered","setEmailEntered","newCardForm","setNewCardForm","cusID","setCusID","paymentMethods","setPaymentMethods","billing","setBilling","billingExists","setBillingExists","disabled","setDisabled","succeeded","setSucceeded","error","setError","processing","setProcessing","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","fetchData","response","get","console","log","data","order","paid","acctid","storename","successurl","returnurl","err","setPaid","post","paymentIntent","e","preventDefault","pi","amount","customer","account","JSON","stringify","handleSubmit","payload","confirmCardPayment","payment_method","card","getElement","message","handleEmailSet","handleEmailPhoneSet","cards","length","handleSetBilling","address","line1","line2","postal_code","editEmail","editBilling","editPhone","cancelEditBilling","isNumeric","n","isNaN","parseInt","isFinite","selectPM","paymentMethod","requestCode","verify","verifyCode","join","code","target","value","map","brand","last4","item","price"],"mappings":"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","sourcesContent":["import React , {Component, useEffect, useState} from 'react';\nimport { useParams} from \"react-router-dom\";\nimport OrderFinder from '../apis/OrderFinder';\nimport EmailPoster from '../apis/EmailPoster';\nimport Cards from '../apis/Cards';\nimport {\n    CardElement,\n    useStripe,\n    useElements\n  } from \"@stripe/react-stripe-js\";\nimport CardForm from './CardForm';\nimport PaymentIntent from '../apis/PaymentIntent';\nimport 'react-phone-number-input/style.css'\nimport PhoneInput from 'react-phone-number-input'\nimport StartVerify from '../apis/StartVerify';\nimport CheckCode from '../apis/CheckCode';\n\nimport OTP from \"./OTP\";\n\n\n\n\nconst Tap = () => {\n    const [otp, setOtp] = useState(new Array(6).fill());\n    const [phoneRequested, setPhoneRequested] = useState(false);\n\n    const {id} = useParams();\n    const [clientSecret, setClientSecret] = useState();\n    const [selectedCard, setSelectedCard] = useState();\n    const stripe = useStripe();\n    const elements = useElements();\n    \n    //from server response\n    const [items, setItems] = useState([]);\n    const [acctID, setAcctId] = useState(\"\");\n    const [storeName, setStoreName] = useState(\"\");\n    const [successURL, setSuccessURL] = useState(\"\");\n    const [returnURL, setReturnURL] = useState(\"\");\n    const [subtotal, setSubtotal] = useState(0);\n    const [shipping, setShipping] = useState(0);\n    const [taxes, setTaxes] = useState(0);\n    const [total, setTotal] = useState(0);\n    const [phoneError, setPhoneError] = useState(false);\n    \n    \n    //billing fields\n    const [name, setName] = useState(\"\");\n    const [addressOne, setAddressOne] = useState(\"\");\n    const [addressTwo, setAddressTwo] = useState(\"\");\n    const [city, setCity] = useState(\"\");\n    const [state, setState] = useState(\"\");\n    const [zip, setZip] = useState(\"\");\n\n    //from customer\n    const [phone, setPhone] = useState(\"\");\n    const [phoneEntered, setPhoneEntered] = useState(false);\n    const [email, setEmail] = useState(\"\");\n    const [emailEntered, setEmailEntered] = useState(false);\n    const [newCardForm, setNewCardForm] = useState();\n   \n\n    //from stripe\n    const [cusID, setCusID] = useState();\n    const [paymentMethods, setPaymentMethods] = useState([]);\n    const [billing, setBilling] = useState([]);\n    const [billingExists, setBillingExists] = useState(false);\n    const [disabled, setDisabled] = useState(true);\n    const [succeeded, setSucceeded] = useState(false);\n    const [error, setError] = useState(null);\n    const [processing, setProcessing] = useState('');\n    \n    \n\n\n    const cardStyle = {\n        style: {\n          base: {\n            color: \"#32325d\",\n            fontFamily: 'Arial, sans-serif',\n            fontSmoothing: \"antialiased\",\n            fontSize: \"16px\",\n            \"::placeholder\": {\n              color: \"#32325d\"\n            }\n          },\n          invalid: {\n            color: \"#fa755a\",\n            iconColor: \"#fa755a\"\n          }\n        }\n      };\n\n    useEffect( () => {\n        \n        const fetchData = async () => {\n        \n        \n        try {\n            const response = await OrderFinder.get(\"/\"+id);\n            console.log(response.data.data);\n            setSucceeded(response.data.data.order[0].paid);\n            \n            setItems(response.data.data.items)\n            setAcctId(response.data.data.order[0].acctid);\n            setStoreName(response.data.data.order[0].storename);\n            setSubtotal(response.data.data.order[0].subtotal);\n            setShipping(response.data.data.order[0].shipping);\n            setTaxes(response.data.data.order[0].taxes);\n            setTotal(response.data.data.order[0].total);\n            setSuccessURL(response.data.data.order[0].successurl);\n            setReturnURL(response.data.data.order[0].returnurl);\n         } catch(err){\n           console.log(err)\n         }\n            \n        \n       }\n       fetchData();\n\n    },[]);\n\n    const setPaid = async () => {\n        try {\n            const response = await OrderFinder.post(\"/\"+id, {\n                paid: true\n            });\n            setSucceeded(true);\n        }\n        catch (err){\n            console.log(error)\n        }\n    }\n        \n\n    const paymentIntent = async (e) => {\n  \n        e.preventDefault();\n        console.log(\"creating payment intent\")\n        try {\n            const pi = await PaymentIntent.post(\"/\", {\n                \n                    amount : total,\n                    customer : cusID,\n                    account: acctID,\n                \n            });\n            console.log(\"payment intent created\"+JSON.stringify(pi))\n            handleSubmit(pi.data.clientSecret);\n        }\n        catch (err){\n            console.log(error)\n        }\n              \n           \n      }\n      \n        const handleSubmit = async (clientSecret) => {\n          console.log(\"confirming payment\")\n          setProcessing(true);\n          const payload = await stripe.confirmCardPayment(clientSecret, {\n            payment_method: (newCardForm ? {\n                card : elements.getElement(CardElement) \n              } : selectedCard.id) \n          });\n          if (payload.error) {\n            setError(`Payment failed ${payload.error.message}`);\n            setProcessing(false);\n          } else {\n              \n            setError(null);\n            setProcessing(false);\n            setSucceeded(true);\n            setPaid();\n           \n          }\n        };\n      \n\n\n    const handleEmailSet = async () => {\n        if(email != \"\"){\n            setEmailEntered(true)\n        }\n        \n    };\n\n\n    const handleEmailPhoneSet = async () => {\n        \n        try{\n            const response = await EmailPoster.post(\"/check/\", {\n                email,\n                phone\n            })\n            console.log(response.data.data)\n            if(!response.data.data.error){\n            setPhoneEntered(true)\n            console.log(\"cusID: \"+response.data.data.customer.id) \n            setCusID(response.data.data.customer.id)\n            if(response.data.data.customer.name != null){\n                setBilling(response.data.data);\n                setBillingExists(true)\n                //if billing, look up cards\n                try {\n                    const cards = await Cards.post(\"/\", {\n                        id: response.data.data.customer.id\n                    });\n                    \n                    if(cards.data.data.paymentMethods.data.length > 0){\n                        console.log(\"card form false\")\n                        setNewCardForm(false)\n                        setPaymentMethods(cards.data.data.paymentMethods.data)\n                        \n                    }\n                    else{\n                        console.log(\"card form true \")\n                        setNewCardForm(true);\n                    }\n                       \n                 } catch(err){\n                   console.log(err)\n                 }\n            }\n            }\n            else{\n                setPhoneError(true)\n            }\n           \n            \n            \n        } catch(err){\n            console.log(err)\n        }\n        \n        \n    };\n\n    const handleSetBilling = async () => {\n        console.log(name)\n        try{\n            const response = await EmailPoster.post(\"/billing/\", {\n                    id: cusID,\n                    name,\n                    address : {\n                        line1 : addressOne,\n                        line2 : addressTwo,\n                        city,\n                        state,\n                        postal_code : zip\n                    },\n                \n            })\n            \n            setBilling(response.data.data)\n            setBillingExists(true)\n            try {\n                const cards = await Cards.post(\"/\", {\n                    id: response.data.data.customer.id\n                });\n                \n                if(cards.data.data.paymentMethods.data!= null){\n                    setPaymentMethods(cards.data.data.paymentMethods.data)\n                }\n                else{\n                    setNewCardForm(true);\n                }\n                   \n             } catch(err){\n               console.log(err)\n             }\n        } catch(err){\n\n        }\n        //load saved cards\n        \n        \n    };\n\n    const editEmail = async () => {\n        setCusID(\"\")\n        setEmailEntered(false)\n        setEmail(\"\")\n        setBilling([])\n        setBillingExists(false);\n        setPaymentMethods([])\n    };\n\n    const editBilling = async () => {\n        setBillingExists(false);\n    };\n\n    const editPhone = async () => {\n        setPhoneEntered(false)\n        setPhoneRequested(false)\n    };\n\n\n    const cancelEditBilling = async () => {\n        setBillingExists(true);\n    };\n\n  function isNumeric(n) {\n    return !isNaN(parseInt(n)) && isFinite(n);\n}\nfunction selectPM(paymentMethod){\n    setSelectedCard(paymentMethod);\n    setDisabled(false)\n}\n\nconst requestCode = async () => {\n    setPhone(phone);\n    setPhoneRequested(true)\n    setPhoneError(false)\n    \n    console.log(\"requesting code\")\n    console.log(\"phone: \"+phone)\n    //setCodeRequested(true);\n    try {\n        const verify = await StartVerify.post(\"/\", {\n            phone\n        });\n        console.log(verify)\n    } catch (error) {\n        console.log(error)\n    }\n}\n\nconst verifyCode = async () => {\n    \n    console.log(\"verifying code: \" +otp.join(\"\"))\n   \n    //setCodeRequested(true);\n    try {\n        const verify = await CheckCode.post(\"/\", {\n            phone,\n            code: otp.join(\"\")\n        });\n        console.log(JSON.stringify(verify))\n        if(verify.data){\n            //setPhoneEntered true\n            \n            \n            handleEmailPhoneSet();\n\n        }\n    } catch (error) {\n        console.log(error)\n    }\n}\n\n    return (\n        <>\n         \n        <div className=\"text-center\">\n            <h1>{storeName}</h1>\n            \n        </div>\n             \n        {succeeded ? \n        <div className={succeeded ? \"p-4 justify-content-center result-message\" : \"p-4 justify-content-center result-message hidden\"}>\n             \n            <div className=\"row\">\n                <p>Payment succeeded! Click below to view your order summary.</p>\n                <div className=\"mt-4 text-center\"><a href={successURL} className=\"btn btn-link p-0 m-0 d-inline align-baseline\">Back</a></div>\n            </div>\n        </div>\n            : \n               \n            <div className=\"row \">\n            <div className=\"col-sm-12\">\n              \n\n            {emailEntered ? \n            <>\n            <div className=\"card mt-4 mb-4 \">\n                <div className=\"card-body\">\n                    \n                    <div className=\"row mt-4\">\n                        <div className=\"col-sm-4\">Email</div>\n                        <div className=\"col-sm-4\"><span>{email}</span></div>\n                        <div className=\"col-sm-2 text-right\"><button className=\"btn btn-link p-0 m-0 d-inline align-baseline\"onClick={editEmail}>edit</button></div>\n                    </div> \n                    {phoneError ? \n                        <div class=\"alert alert-danger\" role=\"alert\">\n                        You entered a phone # that is different from the one you created your account with! Please request a new code with the correct #\n                        </div>\n                        : null}\n                        {phoneEntered ?  \n                        <>\n                        <div className=\"row mt-4\">\n                        <div className=\"col-sm-4\">Phone</div>\n                        <div className=\"col-sm-4\"><span>{phone}</span></div>\n                        <div className=\"col-sm-2 text-right\"><button onClick={editPhone} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >edit</button></div>\n                        </div> \n                        \n                        <div> {billingExists ? \n                        \n                            <div className=\"row mt-4\">\n                                <div className=\"col-sm-4\">Billing Address</div>\n                                <div className=\"col-sm-4\"> \n    \n                                    <div className=\"row\"><span>{billing.customer.name}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.line1}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.line2}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.city}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.state}</span></div>\n                                    <div className=\"row\"><span>{billing.customer.address.zip}</span></div>\n                                </div>\n                                <div className=\"col-sm-2 text-right\"><button onClick={editBilling} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >edit</button></div>\n                                \n                            </div>\n                            \n                            :\n                            \n                             <div className=\"row mt-4\">\n                                 \n                                    <div className=\"col-sm-4\">Enter Billing Address</div>\n                                    <div className=\"col-sm-4\">\n                                        <div className=\"row mt-2\">\n                                            <input \n                                        value={name}\n                                        onChange={(e) => setName(e.target.value)} \n                                        placeholder=\"Full Name\">\n                                            </input></div>\n                                        <div className=\"row mt-2\"><input \n                                        value={addressOne}\n                                        onChange={(e) => setAddressOne(e.target.value)} \n                                        placeholder=\"Address Line 1\"></input></div>\n                                        <div className=\"row mt-2\"><input \n                                        value={addressTwo}\n                                        onChange={(e) => setAddressOne(e.target.value)} \n                                        placeholder=\"Address Line 2\"></input></div> \n                                        <div className=\"row mt-2\"><input\n                                        value={state}\n                                        onChange={(e) => setState(e.target.value)} \n                                        placeholder=\"City\"></input></div> \n                                        <div className=\"row mt-2\"><input \n                                        value={city}\n                                        onChange={(e) => setCity(e.target.value)} \n                                        placeholder=\"State\"></input></div> \n                                        <div className=\"row mt-2\"><input \n                                        value={zip}\n                                        onChange={(e) => setZip(e.target.value)} \n                                        placeholder=\"Zip\"></input></div> \n                                        <div className=\"row mt-2\"><button onClick={handleSetBilling} className=\"btn btn-primary  btn-block \">Save Address</button></div>\n                                    \n                                    </div>\n                                    <div>\n                                        {billing ? null : (billing.customer.name!=false  ?   <div className=\"col-sm-2 text-right\"><button onClick={cancelEditBilling} className=\"btn btn-link p-0 m-0 d-inline align-baseline\" >cancel</button></div>\n                                    : null) }\n                                    </div>\n                                    \n                                \n                             </div>\n                            }</div>\n                            </>\n                        : \n                        \n                                <>\n                                {phoneRequested && !phoneError? \n                                <>\n                                <div >\n                                <OTP otp={otp} setOtp={setOtp} verifyCode={verifyCode}></OTP>\n                                </div>\n                                \n                                </>\n                                \n                                :\n                                <>\n                                <div className=\"row\">\n                                    <div className=\"col\">Phone</div>\n                                    <div className=\"col\"><PhoneInput\n                                        placeholder=\"Enter phone number\"\n                                        value={phone}\n                                        onChange={setPhone}/>\n                                    </div>\n                                \n                                <div className=\"col\"><button onClick={requestCode} className=\"row btn btn-primary\" type=\"submit\">\n                                \n                                Verify Phone to retrieve saved payment data\n                                </button></div>\n                                </div>\n                                </>\n                                }\n                                \n                                \n                                </>\n                                \n                            \n                       }\n                        \n\n                        \n                    \n                        \n                    </div> \n                </div>    \n\n                    {newCardForm && billingExists ? \n                    <div className=\"card mt-4 mb-4 \">\n                        <div className=\"card-header text-center \">\n                            <h4  className=\"text-center\">Save a New Card</h4>\n                            <p>so you don't have to enter it next time!</p>\n                        </div>\n                        <div className=\"card-body\">\n                        \n                            <CardForm setError={setError} setDisabled={setDisabled} setClientSecret={setClientSecret}/>\n                        \n                        {paymentMethods.length > 0 ? <div className=\"col-sm-2\"><button onClick={() => setNewCardForm(false)} className=\"btn btn-link d-inline align-baseline\" >Back to Saved Cards</button></div> : null}\n                        </div>\n                    </div>\n                    \n                    : (billingExists && !newCardForm ? \n                \n                    <div className=\"card text-center mt-4 mb-4 \">\n                            <div className=\"card-header\">\n                                <h4  className=\"text-center\">Saved Cards</h4>\n                            </div>\n                            <div className=\"card-body \">\n                            {paymentMethods.map(paymentMethod=>{\n                                return(\n                                    <div onChange={(e) => selectPM(paymentMethod)} className=\"row \">\n                                        <div className=\"col-xs-3\"><input \n                                        type=\"radio\" \n                                        name=\"addon\" \n                                        /></div>\n                                        <div className=\"col\"><span>{paymentMethod.card.brand} - {paymentMethod.card.last4}</span></div>\n                                    </div>\n                                )\n                            })}\n                             <div className=\"row mt-2\"><button onClick={() => setNewCardForm(true)}className=\"btn btn-primary\">Add a new card</button></div>\n                            </div>\n                        </div> : null)}\n            </>\n               :\n              \n              <div className=\"card\">\n                    <div className=\"card-body\">\n                        <h5 className=\"card-title\">Quick checkout</h5>\n                        <p>Enter your email address to log in or sign up.</p>\n                        <div className=\"\">\n                            \n                            <input \n                            value={email}\n                            onChange={(e) => setEmail(e.target.value)}\n                            placeholder=\"Email address\"\n                            type=\"text\" \n                            className=\"mt-2 mb-2 form-control\" \n                            />\n                            <button onClick={handleEmailSet} className=\"mt-2 mb-2 btn btn-primary btn-block\">Continue with TapPay</button>   \n                        </div>\n                    </div>\n                   \n                </div> \n                }\n                \n        \n                <div className=\"mt-4 text-nowrap card\">\n                    <div className=\"card-header\">\n                        <h4  className=\"text-center\">Order Details</h4>\n                    </div>\n                                <ul className=\"list-group list-group-flush\">\n                    {items.map(item=>{\n                 return(  \n                                <li className=\"list-group-item\">\n                                    <div className=\"row\">\n                                    <div className=\"col\">{item.name}</div> \n                                    <div className=\"col text-right\">${item.price/100}</div>\n                                    </div>\n                                </li>\n                    )\n             })}\n                     </ul>\n                     <div className=\"card-body\">\n                        <ul className=\"list-group list-group-flush\">\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Subtotal</div> \n                                <div className=\"col text-right\">${subtotal/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Shipping</div> \n                                <div className=\"col text-right\">${shipping/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Taxes</div> \n                                <div className=\"col text-right\">${taxes/100}</div>\n                                </div>\n                            </li>\n                            <li className=\"list-group-item\">\n                                <div className=\"row\">\n                                <div className=\"col\">Total</div> \n                                <div className=\"col text-right\">${total/100}</div>\n                                </div>\n                            </li>\n                        </ul>\n                        <form id=\"payment-form\" onSubmit={paymentIntent}>\n                    <div className={succeeded ? \"p-4 row justified-content-center result-message hidden\" : \"p-4 row justified-content-center result-message\" }><button\n                        disabled={processing || disabled || succeeded}\n                        className=\"col btn btn-primary\"\n                    >\n                        <span id=\"button-text\">\n                        {processing ? (\n                            <div className=\"spinner\" id=\"spinner\"></div>\n                        ) : (\n                            \"Pay Now\"\n                        )} \n                        </span>\n                    </button></div>\n                    {/* Show any error that happens when processing the payment */}\n                    {error && (\n                        <div className=\"card-error\" role=\"alert\">\n                        {error}\n                        </div>\n                    )}\n                    \n                    </form>\n                    </div>\n                \n            </div>\n\n            <div className=\"mt-4 text-center\"><a href={returnURL} className=\"btn btn-link p-0 m-0 d-inline align-baseline\">Back</a></div>\n            </div>\n         \n          </div>\n        }\n       \n            \n        </>\n    )\n}\n\nexport default Tap;\n"]},"metadata":{},"sourceType":"module"}